
<!-- Categorical Parallel Coordinate Plots (CPCPs) were created to handle the challenge of representing categorical data in PCPs, which are not suitable for continuous axis representation. -->
CPCPs use discrete axis segments or unique markers for each category, transforming categorical variables into distinguishable visual elements.
<!-- @siirtola2006 introduced axis segmentation, using markers and spacings to represent categorical values distinctly, improving categorical data visualization in PCPs. XXX I cannot figure out where in the 2006 paper this comes up - all the values seem to be numerical XXX --> 
<!-- CPCPs seem to handle both categorical and numeric variables (extracat package, cpcp function - interactive, or scpcp for static plots) -->
Specific strategies, like adjustments to the ends of links, have been suggested to enhance how category and numerical values are connected visually.
This strategy enhances the interpretability of mixed data by modifying the plotting criteria for axes representing category variables.

@inselberg2009 enhanced this representation by introducing specific encodings, which allowed categories to be differentiated visually, preserving the PCP's interpretative power.
@johansson2015 explored alternative segmentation methods to minimize visual clutter, enabling effective handling of multiple categorical values on the same axis.

<!--CPCPs adjust by organizing categorical axes more clearly or using symbols and colors to represent categories for easier interpretation. [Is this actually a CPCP development, or did it just develop alongside the idea of CPCPs? It seems like it would apply to all PCP-variants.]{.svp}-->


<!-- XXX None of these papers seem to be specifically related to CPCPs -- need to be very strict at distinguishing one type of thing from another. I'm not saying these aren't relevant, but if they are, put them somewhere else - right now, this section is more of a "junk drawer" in a kitchen than an organized space. XXX
Designed to accommodate categorical data using methods including axis restructuring, symbols, and color-coding to increase clarity and comprehension, Categorical Parallel Coordinate Plots (CPCPs) are a development of Parallel Coordinate Plots (PCPs).
Looking at the given papers, CPCPs come from more general ideas than from them straightforwardly.
Although it does not particularly address categorical variables, @Wegman:1990 groundbreaking study on PCPs offers the mathematical underpinning for visualizing high-dimensional numerical data.
Every PCP invention, including CPCPs, is built on this work.
@leblanc1990 investigation of PCPs for assessing concurrent program performance emphasizes PCP adaptability but mainly focuses on numerical or sequential data rather than categorical data.

@holten2009's work on force-directed edge bundling aims to improve graph visualizations by lowering visual clutter, which guides the CPCP objectives of increasing interpretability.
Though it has nothing to do with PCPs or categorical data, its primary goal is to make complex data visualizations more readable.
Therefore, even if these papers specifically address CPCPs, they add to the larger conversation on developing multidimensional visualizing techniques.

Beyond categorical data, the CPCP innovations—axis structure and the use of symbols and colors—are relevant to additional PCP versions. 
These ideas improve the interpretability of interactive PCPs, hybrid PCPs combining data kinds, and continuous PCPs. 
CPCPs observe both a tool for categorical data but also larger progress in multidimensional data display.
-->


<!--[@Wegman:1990]{.db} suggested using symbols and color codes to represent categories, improving how categorical data is understood in parallel coordinates.
[@holten2009]{.db} introduced color gradients for categories to facilitate distinguishing between multiple categorical values, especially in the analysis of intricate datasets.
[@leblanc1990]{.db} highlighted the significance of arranging axes in CPCPs, positioning categories with strong relationships closer together to assist users in making meaningful comparisons.-->

```{r}
#| echo: false
#| warning: false
#| label: fig-hybrid
#| layout-valign: bottom
#| fig-subcap: 
#|   - "Categorical and Hybrid in PCP"
#| fig-width: 8
#| fig-height: 6
#| 
# Remove rows with missing data from the dataset
penguins_clean_cat <- penguins %>%
  na.omit() %>%
  select(-year)

# Convert categorical variables to factors
penguins_clean_cat <- penguins_clean_cat %>%
  mutate(island = as.factor(island),
         sex = as.factor(sex),
         species = as.factor(species))

# Create a parallel coordinate plot using both numeric and categorical variables

penguins_clean_cat %>%
  pcp_select(2:7) %>%
  pcp_scale(method="uniminmax") %>%
  pcp_arrange() %>%
  ggplot(aes_pcp()) +
  geom_pcp_axes() +
  geom_pcp(aes(colour = species)) +
  ggplot2::theme_bw() +
  ggplot2::labs(title = "Parallel Coordinate Plot with Categorical and Hybrid PCP") +
  facet_wrap(~sex)+ 
  guides(color = F) +
  penguin_scale_color()
```

The Generalized Parallel Coordinate Plot (GPCP) is a modified version of the original PCP that introduces 
<!-- XXX??? nonlinear XXX -->
changes to the axes [to allow for]{.svp} more complex data representation.
<!-- These can show more complicated relationships in the data that might not be visible in a regular PCP. -->
<!-- No, they allow categorical and numerical variables to be shown while maintaining the ability to distinguish single observations...  -->
Nonlinear scales such as logarithmic and exponential transformations are possible.


<!-- Not sure where this should go, but it's not here....? -->
<!-- @wegman1997a provide a comprehensive discussion of the GPCP idea stating, "The parallel coordinate plot is a geometric device for displaying points in high-dimensional spaces, in particular, for dimensions above three.  -->
<!-- As such, it is a graphical alternative to the conventional scatterplot." -->
<!-- The authors enable the visualization of data distributions, correlations, clusters, and higher-dimensional structures by connecting Cartesian and parallel coordinate representations. -->
<!-- The "grand tour" idea is important for seeing how dynamic high-dimensional structures change over time because it allows data analysts to examine very large and very complex data sets.  -->
<!-- This method avoids the problems of axis adjacency in PCPs by constantly rotating the data axes.  -->
<!-- It ensures that every possible combination of variables is explored dynamically. -->
<!-- These new ideas greatly improve the ease and usefulness of PCPs, making them more useful in many situations and giving us tools for exploring and analyzing data in the modern world, [@wegman1997]. -->

# All Sections Moved for Flow

## Bundling and Curving

Bundling and curving techniques have emerged as practical solutions for managing visual clutter in high-dimensional data visualizations.
These methods group similar paths, reduce overplotting and make overarching patterns more visible. 
By organizing the chaotic lines often seen in parallel coordinate plots (PCPs), bundling and curving enhance interpretability. 
As noted by @holten2009, bundling provides a compelling strategy to mitigate the visual complexity frequently encountered in these datasets.

Building on this concept, @mcdonnell2008 introduced curvilinear PCPs, leveraging curved lines to distinguish intersecting paths and improve visual clarity. 
Subsequently, @johansson2015 assessed the effectiveness of bundling and curving in PCPs, offering criteria for when these modifications are most beneficial for interpretability.

Curving lines in PCPs can be adapted based on data attributes, enabling better visual separation and pattern recognition.
This is particularly advantageous when working with strongly correlated dimensions, where overlapping paths obscure relationships. 
Curved lines visually separate trajectories by reducing intersections, making data relationships easier to discern. 
Additionally, they enhance aesthetic appeal and reduce cognitive load, improving the overall readability of visualizations. 
Curved lines offer a more intuitive perception of relative data positions by simulating a three-dimensional effect within a two-dimensional space. 
Research supports these benefits, with studies showing that curving lines reduces clutter and improves data interpretation [@fua1999, @qu2007]. 
This approach has proven effective in handling complex datasets with overlapping points [@kachhway2013].


```{r}
#| echo: false
#| warning: false
#| label: fig-bundling
#| layout-valign: bottom
#| fig-subcap: 
#|   - "A Bundling and Curving Parallel Coordinate Plot"

penguins_clean <- penguins %>%
  na.omit() %>%
  mutate(species = as.factor(species)
         ) %>%
  select(-island, -sex, -year)


# Create a parallel coordinate plot with bundling and curving
ggparcoord(
  penguins_clean,
  columns = 2:5, # Using the numeric columns
  groupColumn = 1,
  alphaLines = 0.5,
  splineFactor = 5
) + theme_minimal() +
  labs(title = "Parallel Coordinate Plot with Bundling and Curving") +
  penguin_scale_color() +
  guides(color = F)
```

In @fig-bundling, a PCP modified with bundling and curving demonstrates how these techniques smooth lines, reduce distractions and highlight patterns across different species. 
Bundling reveals general trends within each species, but it lacks the detail to show specific distribution shapes, such as those visible in histograms. 
A notable trade-off of bundling is its tendency to obscure outliers, as extreme values are pulled into the primary flow, making deviations harder to detect. 
However, curved lines make variable relationships more apparent, indicating that specific measurements rise or fall together depending on the species. 
Despite this, minor differences between individual points may be harder to discern.

@moustafa2011 expanded on PCPs by integrating them with parallel coordinate density plots (PCDPs) to effectively manage large datasets. 
By transforming PCP images with density estimation methods, Moustafa’s approach converts polylines into continuous, smooth depictions of data density. 
This innovation highlights groupings and trends often hidden in traditional PCPs. 
Moreover, the interactive elements of Moustafa’s methodology allow users to explore different dimensions in real time, making the visualization accessible even to non-experts. 
This interactivity significantly enhances the analytical capabilities of PCPs.

While bundling simplifies complex datasets and reduces visual clutter, it has limitations. 
Grouping similar paths can obscure individual data points and outliers, which may be critical in specific analyses. 
McDonnell and Mueller caution that the clarity achieved through bundling may compromise data precision, as unique data paths or outliers are often lost in the simplification process [@mcdonnell2008].

### Enhanced Color Encoding and Shading

Visual enhancements such as color coding, opacity modifications, and line thickness adjustments have been implemented to address overplotting, particularly in large datasets. 
These upgrades allow significant data trends to stand out while less relevant information is minimized. 
For instance, varying colors or adjusting line opacity based on data density helps users identify trends and outliers that might otherwise remain hidden. 
Similarly, modifying line thickness to represent variables such as data frequency or confidence intervals adds depth to the visualization. 
These multi-layered techniques enrich traditional parallel coordinate plots (PCPs) by encoding additional dimensions of information.

In their comprehensive review, State of the Art of Parallel Coordinates, @heinrich2013 discusses numerous methods to reduce overplotting and improve data interpretation. 
Techniques such as alpha blending, which adjusts line transparency to minimize visual clutter, and interactive line manipulation, which allows users to explore data in real time, are highlighted as essential tools for enhancing PCP readability in large datasets.

Building on these foundations, @blaas2008 emphasized the importance of dynamic visual traits like adjustable colors and opacity in their study Extensions of Parallel Coordinates for Interactive Exploration of Large Multi-Timepoint Data Sets. 
Their approach enables real-time modification of visual settings, allowing users to focus on specific data features and control line density. 
Similarly, @raidou2015, in Orientation-Enhanced Parallel Coordinate Plots, demonstrated how varying opacity levels and color gradients can draw attention to patterns, show line densities, and facilitate interactive exploration. 
These strategies effectively tackle overplotting challenges in complex datasets by employing techniques such as smoothing and averaging polylines.

The work of @zhou2008 in Visual Clustering in Parallel Coordinates introduced a user-driven approach to highlight data clusters using customizable color and opacity settings. 
This technique differentiates data groups and reshapes curves to enhance clarity. 
Likewise, @fua1999's Hierarchical Parallel Coordinates for Exploration of Large Datasets proposed reducing visual clutter through hierarchical representations and variable line thickness. 
By effectively visualizing data density, these methods reveal trends otherwise obscured in large datasets.

Color gradients and shading have emerged as powerful tools to encode additional data attributes, such as density or frequency, in PCPs. 
Using these visual encodings, users can identify trends and correlations more effectively. 
For example, color gradients transform PCPs from purely structural plots into tools for multi-dimensional analysis. 
As @theus2008 demonstrated with color-coded PCPs, mapping additional variables through color significantly enhances interpretive power. 
This approach was further refined by @bertini2005, who applied density shading techniques to make frequent patterns in large datasets more visible. 
@novotny2006 expanded on this work with opacity and color-blending techniques, making overlapping patterns easier to interpret intuitively.

However, reliance on color-based encoding poses challenges. 
Overusing colors or gradients can lead to visual strain and reduce clarity, especially for users with color vision deficiencies. 
Bertini et al. noted that excessive color application risks overwhelming the viewer, making the visualization more confusing rather than more insightful.

These studies underscore the importance of adapting visual attributes in PCPs to address overplotting and improve interpretability. 
By incorporating techniques like color coding, opacity adjustments, and line thickness modifications, PCPs become more effective tools for analyzing multi-dimensional datasets. 
However, balancing these enhancements to maintain their usability is essential, particularly for diverse audiences. 
Thoughtful application of these techniques ensures that PCPs remain accessible, clear, and insightful for exploring complex datasets.

```{r}
#| echo: false
#| warning: false
#| label: fig-encoding
#| layout-valign: bottom
#| fig-subcap: 
#|   - "Enhanced Color Encoding and Shading in PCP"

# Create a parallel coordinate plot with enhanced color encoding and shading
ggparcoord(
  data = penguins_clean,
  columns = 2:5, # Using the numeric columns
  groupColumn = 1,
  scale = "uniminmax", # Scale columns to range between [0, 1]
  alphaLines = 0.5, # Set transparency for lines
  #showPoints = TRUE, # Show points on lines
  mapping = ggplot2::aes(color = species), # Color lines by species
  shadeBox = NULL # Use to add shading to enhance visual distinction between variables
) +
  penguin_scale_color() +
  ggplot2::theme_minimal() +
  guides(color = F) +
  ggplot2::labs(title = "Parallel Coordinate Plot with Enhanced Color Encoding and Shading")
```

The parallel coordinate plot illustrated in @fig-encoding employs enhanced color coding to distinguish between species effectively. 
Each species is represented by a distinct color: red for Adelie, green for Chinstrap, and blue for Gentoo.
Adjustments to line density further highlight the differences between species across key variables such as bill length, bill depth, flipper length, and body mass. 
This approach successfully conveys general trends for each species, such as the Gentoo's higher flipper length and body mass values than the Adelie, which typically exhibits lower values.

Despite these enhancements, overplotting remains an issue, particularly around the middle ranges of each axis. 
This visual congestion obscures slight differences and makes identifying outliers challenging. 
While the plot does not explicitly show the distribution shapes of individual variables, the grouping of lines along each axis hints at central tendencies for each species. 
For instance, clustered lines suggest shared characteristics within species, though these clusters lack precision in depicting variability.

The general trends revealed in the plot suggest relationships between numerical factors, but the overlapping lines make it difficult to isolate individual correlations. 
While this visualization provides a broad overview of trends across species, its ability to pinpoint specific data points or detect rare observations is limited. 
To enhance its utility, further modifications—such as interactive features or additional encoding dimensions—could help overcome these limitations and improve the analysis of individual patterns within the data.


## Dimension Reduction Techniques

Dimensionality reduction techniques, such as Principal Component Analysis (PCA) and Independent Component Analysis (ICA), are widely used to improve the readability of parallel coordinate plots (PCPs) before visualization. 
These methods reduce the number of dimensions while retaining the most significant aspects of the data, simplifying analysis without losing critical information. 
PCPs of reduced dimensions precisely depict high-dimensional interactions, making patterns and relationships easier to discern.

In addition to dimensionality reduction, axis ordering is crucial in enhancing PCPs. 
The relationships between variables become more apparent by arranging axes based on correlation, mutual information, or other metrics. 
Automated axis arrangement techniques have been developed to reduce line crossings, significantly improving the identification of patterns. 
These optimizations make PCPs a more effective tool for exploring complex datasets.

The Orientation-Enhanced Parallel Coordinate Plots technique, introduced by @raidou2015, represents a significant innovation in making PCPs more accessible and informative. 
This method addresses common challenges such as clutter and overlapping lines by dynamically adjusting plot axis orientations. 
By applying both automatic and user-interactive adjustments, this approach reduces visual noise and highlights meaningful data patterns and correlations. 
Modifying axis orientation on the fly offers users greater control over the visualization, enabling more precise analysis of large datasets.

Orientation-enhanced PCPs incorporate preprocessing steps like PCA and multi-dimensional scaling (MDS) to optimize axis arrangements. 
These techniques ensure that data clusters are well-separated and that overlapping lines are minimized. 
Interactive features further empower users to customize the orientation based on their specific research needs, making these plots adaptable to various analytical scenarios [@raidou2015].

Reducing dimensions has become essential for managing the complexity of PCPs when visualizing high-dimensional data. 
Techniques such as PCA and clustering allow analysts to focus on the most critical features of the data while reducing visual overload. 
PCA, for example, condenses the data into components that capture the majority of variance, ensuring essential information is retained. 
Similarly, clustering simplifies the dataset by grouping similar features, making trends more discernible.
@wegman1997 demonstrated the value of PCA within PCPs by enabling users to represent key data features while discarding less relevant dimensions. 
Further advancements by @guo2012 introduced hierarchical dimension reduction and clustering techniques, streamlining the analysis of high-dimensional datasets while preserving usability. 
As explored by @yang2017, non-linear methods further enhanced PCPs by capturing complex, non-linear relationships that traditional techniques might overlook.

While dimension reduction offers significant advantages, it has trade-offs. 
Techniques like PCA or clustering can inadvertently remove subtle nuances or minor patterns, potentially masking relationships that exist only in higher-dimensional spaces. 
@guo2012 cautioned that these beneficial methods might lead to information loss, particularly for niche analyses where fine-grained details are crucial.

By balancing the need for simplification with careful consideration of the data's nuances, PCPs can effectively represent high-dimensional datasets while maintaining their interpretive power. 
Combining dimensionality reduction, axis optimization, and user-interactive features ensures that PCPs remain robust tools for exploring and analyzing complex data.


```{r}
#| echo: false
#| warning: false
#| label: fig-pca
#| layout-valign: bottom
#| fig-subcap: 
#|   - "A PCA in Parallel Coordinate Plot"


# Remove rows with missing data from the dataset
penguins_clean <- penguins %>%
  na.omit() %>%
  select(-island, -sex, -year)

# Perform PCA on the numeric columns
penguins_pca <- prcomp(penguins_clean %>%
                         select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g),
                       center = TRUE, scale. = TRUE)

# Create a data frame with the PCA results
penguins_pca_df <- as.data.frame(penguins_pca$x)
# Add species as a categorical variable to the PCA data frame
penguins_pca_df$species <- penguins_clean$species

# Create a parallel coordinate plot using ggparcoord for the PCA results
ggparcoord(
  data = penguins_pca_df,
  columns = 1:4, # Using the PCA components
  groupColumn = 5,
  scale = "uniminmax", # Scale columns to range between [0, 1]
  alphaLines = 0.3, # Set transparency for lines
  #showPoints = TRUE, # Show points on lines
  mapping = ggplot2::aes(color = species) # Color lines by species
) +
  penguin_scale_color() +
  ggplot2::theme_minimal() +
  ggplot2::labs(title = "Parallel Coordinate Plot with PCA elements") + 
  guides(color = F)

```

In @fig-pca, the parallel coordinate plot leverages principal component analysis (PCA) to simplify high-dimensional data. 
The x-axis represents PCA components (PC1 to PC4), while the y-axis displays scaled PCA values, color-coded by species: Adelie (red), Chinstrap (green), and Gentoo (purple). 
PCA encapsulates complex relationships into fewer dimensions by reducing the original variables into principal components, allowing for a more precise depiction of overall trends.

The lines connecting the components highlight how each penguin transitions across these derived features, making species-level patterns more discernible in the reduced dimensional space. 
Despite this, overplotting persists due to the numerous overlapping lines, particularly in densely populated regions. 
However, distinct separations between species emerge along specific principal components, showcasing PCA’s utility in revealing broad group-level trends.

Clusters around the PC axes indicate each species' general concentration of values, hinting at their central tendencies in the reduced space. 
While explicit distribution shapes are not depicted, these clusters offer insight into species-specific patterns. 
Color-coded lines and groupings emphasize the relationships between PCs and species, suggesting that specific principal components contribute to species separation. 
However, the bundling effect of overlapping lines makes detecting outliers and understanding individual variability more challenging.

This visualization demonstrates the potential of PCA in reducing dimensional complexity and enabling the identification of trends in large datasets. 
While PCA’s abstraction simplifies relationships, trade-offs remain in preserving fine-grained details and outlier visibility, underscoring the importance of complementary techniques for in-depth analysis.


## Cluster-Based and Hierarchical PCPs

Clustering techniques, such as spectral clustering, have proven instrumental in improving the interpretability of parallel coordinate plots (PCPs) by grouping related data points and revealing underlying structures in high-dimensional datasets. 
These methods allow analysts to uncover patterns and relationships not immediately evident in raw data, providing insights into the natural grouping of data points [@zhao2012]. 
Visualizing clusters in PCPs makes connections between data points and cluster features more apparent, facilitating a deeper understanding of complex datasets.

Before generating PCPs, data reduction techniques such as hierarchical clustering and principal component analysis (PCA) are often employed. 
These strategies focus on the most significant components that explain the majority of the variance in the data, limiting the number of dimensions visualized and reducing visual clutter. 
This preprocessing step enhances the clarity and utility of PCPs, mainly when dealing with large, multidimensional datasets.

The study Structure Revealing Techniques Based on Parallel Coordinates Plot by @zhao2012 highlights the limitations of traditional PCPs in uncovering important patterns within high-dimensional data, particularly when faced with challenges like overplotting. 
To address these issues, the authors propose clustering and sorting techniques designed explicitly for PCPs. 
By leveraging spectrum theory, algorithms are developed to group similar polylines, reducing visual clutter and exposing hidden trends and correlations.

Additionally, the study introduces a correlation-based sorting method to arrange axes in a way that highlights relationships between variables. 
This systematic approach enables the visualization of trends across dimensions, making it easier to interpret complex data. 
Including view-range metrics further improves data clarity by aggregating and limiting noisy datasets. 
Experimental results demonstrate that these enhancements significantly improve PCPs’ ability to reveal valuable patterns, trends, and correlations, enabling more efficient data analysis.

For multidimensional datasets, clustering, and hierarchical PCPs provide structured and organized visualizations, making comparing clusters and identifying trends easier. 
Hierarchical clustering enhances the narrative of PCPs by presenting high-level overviews and detailed views, as argued by @fua1999. 
This dual perspective allows analysts to observe the big picture while examining finer details within subsets of the data.

@fua1999 pioneered hierarchical PCPs with a zoomable interface, enabling users to explore data clusters and delve into specific subsets for detailed analysis. 
@geng2005 expanded on this concept by applying clustering to group similar data points, highlighting patterns, and making general trends more accessible. 
Further advancements by @poco2011 incorporated hierarchical clustering with user-defined granularity levels, providing flexible and interactive visualizations tailored to analytical needs.

While clustering simplifies data visualization and enhances the accessibility of patterns in PCPs, it comes with trade-offs. The grouping of data points can obscure individual data, particularly outliers. 
@geng2005 observed that clustering effectively identifies general patterns but may mask unique or significant findings hidden within homogenous groups. 
To strike a balance, analysts must carefully weigh the benefits of clustering against the potential loss of detail, ensuring that the visualization supports broad overviews and detailed investigations.

By integrating clustering techniques, hierarchical approaches, and correlation-based sorting methods, PCPs have evolved into more powerful tools for exploring high-dimensional datasets. 
These advancements enhance the visualization’s ability to expose hidden structures while maintaining flexibility for detailed analysis, making PCPs indispensable in modern data analysis workflows.



```{r}
#| echo: false
#| warning: false
#| label: fig-cluster
#| layout-valign: bottom
#| fig-subcap: 
#|   - "Cluster-Based PCP"

# Select only numeric columns for clustering
penguins_numeric <- penguins_clean %>%
  select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)

# Perform hierarchical clustering
penguins_dist <- dist(penguins_numeric)
penguins_hclust <- hclust(penguins_dist, method = "ward.D2")

# Cut the dendrogram into 3 clusters
penguins_clusters <- cutree(penguins_hclust, k = 3)

# Add cluster information to the dataset
penguins_clean$cluster <- as.factor(penguins_clusters)

# Create a parallel coordinate plot with clusters using ggparcoord
ggparcoord(
  data = penguins_clean,
  columns = 2:5, # Using the numeric columns
  groupColumn = "cluster",
  scale = "uniminmax", # Scale columns to range between [0, 1]
  alphaLines = 0.5, # Set transparency for lines
  #showPoints = TRUE, # Show points on lines
  mapping = ggplot2::aes(color = cluster)
) +
  scale_color_manual(values = c("1" = "#540D6E", "2" = "#219B9D", "3" = "#FF8000")) +
  ggplot2::theme_minimal() +
  ggplot2::labs(title = "Parallel Coordinate Plot with Cluster-Based") + 
  guides(color = F)
```

## Optimized Layout Algorithms

Layout algorithms for parallel coordinate plots (PCPs) have been refined to improve clarity by minimizing line crossings, which is critical when visualizing high-dimensional data. 
An optimized layout enhances the readability of PCPs by reducing visual clutter and facilitating smoother navigation. 
Effective design often determines whether a PCP is comprehensible or chaotic [@ankerst1998].
<!--[Is there a user study showing that this makes PCPs easier to read?]{.svp}-->
In an empirical analysis using three visualization techniques, including PCPs, researchers compared conventional sequential layouts with similarity-based arrangements. 
Their findings revealed that similarity-based configurations significantly enhanced readability by grouping comparable dimensions, making patterns, correlations, and functional connections more apparent. 
This alignment of similar dimensions allows for more precise identification of trends, underscoring the impact of thoughtful axis arrangement.


Heuristic layout algorithms in PCPs often generate results misaligned with specific user-defined analytical needs [@johansson2005]. 
To address this limitation, @johansson2005 introduced an optimized axis positioning algorithm to maximize spacing between overlapping lines, thereby improving data distinction. 
In this context, data distinction refers to the ability to expose significant structures within dense PCPs, such as cluster formations, local outliers, and intensity fluctuations.

Johansson's work incorporates clustering, high-precision texturing, and transfer functions (TFs) to highlight multiple data properties. 
These innovations allow users to discern cluster structures, detect local outliers, and examine intensity variations in large datasets. 
Techniques like logarithmic TFs reveal dense structures and subtle patterns, while variance-based feature animation highlights areas requiring closer analysis. 
These methods, evaluated on datasets with up to 100,000 data points, demonstrate the capacity of PCPs to visualize complex trends and sub-clusters efficiently.

<!--[You need to show these different options and comment on the differences! Provide more detail about whether experimental evidence supports the approach. How does the approach in @ankerst1998 compare to the ggpcp ordering approach to minimize line crossings in one direction or another for categorical variables? I suspect that these algorithms change axis positioning, where ggpcp changes ordering within a category -- but you need to explicitly make that comparison.]{.svp}-->

Two notable approaches for optimizing PCPs include the Similarity Clustering Approach [@ankerst1998] and the Clustered Parallel Coordinates with High-Precision Textures [@johansson2005]. 
Both methods enhance interpretability by focusing on dimensional relationships, albeit with differing priorities.

- Similarity Clustering Approach (@ankerst1998): This method emphasizes arranging dimensions based on functional similarities and correlations rather than explicitly reducing line crossings. 
Grouping related variables facilitates the discovery of patterns and connections, enhancing interpretability in datasets with strong inter-variable relationships. 
However, it is less effective for categorical data where reducing line crossings is critical.

- Clustered PCPs with High-Precision Textures (@johansson2005): This approach addresses visual clutter by aggregating data points into clusters and representing them with high-precision textures. 
Transfer functions and outlier detection reduce overplotting and highlight significant data features without altering dimension arrangements. 
While effective for trend and structure visualization, it does not tackle dimension reordering to minimize crossings.

The `ggpcp` method minimizes line crossings in PCPs, particularly for categorical variables. 
It provides a direct solution for visual clutter by optimizing variable order, making it ideal for datasets where reducing overlap is a priority. 
However, its focus on categorical data limits its applicability to broader multidimensional contexts.

In contrast, the methods proposed by @ankerst1998 and @johansson2005 address broader interpretive challenges in PCPs. 
The former prioritizes grouping similar dimensions to highlight functional correlations, while the latter enhances visual representation through clustering and advanced texturing techniques. 
These approaches suit numerical and high-dimensional datasets where trends and relationships require detailed exploration.

Each method offers unique strengths and is best suited for specific use cases. 
The Similarity Clustering Approach and Clustered PCPs excel in revealing trends and relationships in numerical data, while `ggpcp` is better equipped to handle categorical data by reducing line crossings. 
These methods illustrate the diverse strategies for optimizing PCPs, ensuring their adaptability to various analytical needs and datasets. 
While they share a common goal of improving interpretability, their distinct methodologies cater to different aspects of the visualization challenge, from structural clarity to categorical simplification.


```{r}
#| echo: false
#| warning: false
#| label: fig-optimized
#| layout-valign: bottom
#| fig-cap: "While the PCP employs an optimized layout, its clarity is compromised by overplotting, lack of clustering or feature enhancement, and minimal reduction in line crossings. Clustering, high-precision textures, and transfer functions could greatly improve readability by simplifying data representation and directing attention to key features."

# Calculate the correlation matrix for optimized ordering
cor_matrix <- cor(penguins_clean %>%
                    select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g))

# Find the order of variables that maximizes the interpretability (based on correlation)
order_vars <- order.dendrogram(as.dendrogram(hclust(as.dist(1 - cor_matrix))))
penguins_optimized <- penguins_clean %>%
  select(all_of(order_vars), body_mass_g)

# Create a parallel coordinate plot with optimized layout using ggparcoord
ggparcoord(
  data = penguins_optimized,
  columns = c(1,3:5), # Using the optimized numeric columns
  groupColumn = "species",
  scale = "uniminmax", # Scale columns to range between [0, 1]
  alphaLines = 0.5, # Set transparency for lines
  #showPoints = TRUE, # Show points on lines
  mapping = ggplot2::aes(color = species)
) +
  penguin_scale_color() +
  ggplot2::theme_minimal() +
  ggplot2::labs(title = "Parallel Coordinate Plot with Optimized Layout") + 
  guides(color = F)
```


## Axis Reordering

As mentioned in the section on modifications, axis reordering changes the order of dimensions to reduce the number of times lines cross between variables in PCPs, a type of data display.
This method makes clusters easier to see by lining up visually linked variables, cutting down on clutter, and making patterns stand out more without overlapping.
One benefit is that it works well for datasets where certain factors are strongly related, making clusters and trends easier to read without changing the data.
Changing the variable order for clarity rather than data continuity could make it hard to tell if the data is in order.
@blumenschein2020 say that reordering based on correlation minimizes unnecessary line intersections, allowing natural clusters to emerge. This shows how important changing the arrangement can be for seeing clearly.
Studies in this area have shown that changing the order of dimensions makes it much easier to find patterns in datasets where dimensions are linked.
However, it only works well on datasets with dimensions tied together.

```{r}
#| echo: false
#| warning: false
#| label: fig-axis
#| layout-valign: bottom
#| fig-subcap: 
#|   - "PCP Without Axis Reordering"
#|   - "PCP With Skewness Axis Reordering"
#| fig-width: 8
#| fig-height: 4
#| layout-ncol: 1

penguins <- na.omit(penguins)

# Example of a parallel coordinate plot without handling ties explicitly
p1 <- ggparcoord(
  data = penguins,
  columns = 3:6,  # Columns for numerical features (bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)
  groupColumn = 1,
  scale = "uniminmax",  # Scaling to [0, 1] for better visualization
) +
  #ggtitle("Without Axis Reordering")  +
  theme_minimal() +
  penguin_scale_color() + 
  guides(color = F) 

# Example of a parallel coordinate plot with axis reordering to minimize tie overlap
p2 <- ggparcoord(
  data = penguins,
  columns = 3:6,  # Columns for numerical features
  groupColumn = 1,
  scale = "uniminmax",
  order = "skewness") + # skewness axis reordering to handle ties and improve interpretability
  penguin_scale_color()+   
  #ggtitle("With Skewness Axis Reordering") +
  theme_minimal() +
  guides(color = F) 

# Try using patchwork. Think about removing the legend and adding that in the section.
grid.arrange(p1,p2, ncol=2)

```

## Line Bundling


By putting similar lines into "bundles," line bundling cuts down on unnecessary crossings and clutter.
This method works well in dense PCPs, where many lines cross and make it hard to see individual patterns.
Heinrich et al. say that "bundling lines based on value similarity reduces cognitive strain and enhances visual coherence in complex datasets." This shows how bundling can make complex data easier to understand without losing larger patterns.
Experiments have shown that bundling makes large datasets easier to read, which makes it easier to find general trends even when the data is heavily packed [@heinrich2011].
It makes things easier to understand by collecting similar data lines; this works especially well for numerical ties where values are close but not exactly the same.
Bundling, on the other hand, can hide individual lines within a group, making it hard to tell one data point from another.


## Quantization and Aggregation

Quantization, referred to as Quantized Generalized Parallel Coordinate Plots (QGPCP), is a technique that groups close-together values into bins, reducing visual clutter and improving the readability of tightly packed data. 
This method is particularly effective for managing large datasets, where overplotting and excessive line crossings obscure meaningful trends and patterns.

By aggregating similar values into quantized bins, QGPCP simplifies visualizations without significantly altering the overall data structure. 
As Moustafa explains, "By quantizing close data points, we can minimize overplotting and improve discernment of overall trends." 
This highlights the trade-off inherent in quantization: sacrificing granular detail to enhance interpretability. 
Tests on real-world data have demonstrated that this approach preserves important patterns while reducing visual noise, making it an invaluable tool for exploring high-dimensional datasets.

Quantization excels in scenarios where high-dimensional datasets result in extensive line overlap. 
By reducing the number of distinct lines in a parallel coordinate plot (PCP), this method creates a cleaner, more navigable visualization. 
Key benefits of quantization include:

- Improved Clarity: Aggregating close values minimizes line crossings, enabling users to discern trends more quickly. 
Patterns previously obscured by overplotting become more apparent, enhancing the user's ability to interpret the data.

- Noise Reduction: By removing small-scale variations, quantization reduces the visual complexity of the plot. 
This makes it easier for analysts to focus on larger trends and relationships across dimensions.

- Scalability: Quantization is particularly effective for large datasets, where traditional visualization methods struggle to handle the volume of overlapping data points. 
Aggregating values optimizes visualizations for datasets with high-dimensional complexity.

While quantization simplifies visualizations, it has limitations that make it less suitable for specific analytical contexts. 
Chief among these is the potential loss of detail. 
Aggregating values into bins can obscure small but meaningful differences, which may be critical in scenarios requiring precision. 
For example:

- Loss of Granularity: By grouping data points, quantization may mask outliers or subtle variations that provide valuable insights.

- Bias in Representation: The choice of bin size and boundaries can influence the visualization, potentially introducing artifacts or skewing interpretations.

- Limited Utility for Precision Tasks: Quantization may oversimplify the visualization for analyses that demand exact data representation, such as identifying specific outliers or subtle correlations.

As Moustafa notes [@moustafa2009], the method’s strength lies in its ability to simplify densely packed datasets, which comes at the cost of fine-grained detail. 
Thus, the technique is best suited for exploratory analyses where the goal is to identify broad patterns rather than focus on precise data points.



```{r}
#| echo: false
#| warning: false
#| label: fig-qgpcp
#| layout-valign: bottom
#| fig-subcap: 
#|   - "Quantized Generalized Parallel Coordinate Plots"
#|   
# Remove rows with NA values for simplicity
penguins_clean <- penguins %>% 
  na.omit()

# Discretize/Quantize numerical columns and encode categorical variables
penguins_encoded <- penguins_clean %>%
  mutate(
    species = as.factor(species),  # Encode species as numeric
    island = as.numeric(as.factor(island)),    # Encode island as numeric
    sex = as.numeric(as.factor(sex)),          # Encode sex as numeric
    bill_length_mm = cut(bill_length_mm, breaks = 5, labels = FALSE),  # Quantize bill_length_mm
    bill_depth_mm = cut(bill_depth_mm, breaks = 5, labels = FALSE),    # Quantize bill_depth_mm
    flipper_length_mm = cut(flipper_length_mm, breaks = 5, labels = FALSE), # Quantize flipper_length_mm
    body_mass_g = cut(body_mass_g, breaks = 5, labels = FALSE)         # Quantize body_mass_g
  )

# Create the parallel coordinate plot
ggparcoord(
  data = penguins_encoded,
  columns = 3:6,    # Use all columns, including encoded categorical variables
  groupColumn = 1,  # Grouping by species
  scale = "uniminmax", # Scale columns to the same range
  #showPoints = TRUE,   # Show points on the lines
  alphaLines = 0.5     # Transparency of lines
) + 
  theme_minimal() + 
  labs(title = "Quantized Parallel Coordinate Plot of Palmer Penguins Dataset") +
  guides(color=F) +
  penguin_scale_color()
```

In @fig-qgpcp, the overlapping of the Quantized Parallel Coordinate Plot makes it harder to find specific individuals.
Quantization makes the visualization even easier by putting numbers into groups.
However, this needs to improve some of the accuracy of the original data.
The plot can help you see big patterns, like how some species may follow similar paths across many traits, but it doesn't show exactly how they are related or where they live.
Using jittering or interactive plots to cut down on overplotting could make things clearer and make figuring out how factors relate easier.

Quantization, or QGPCP, is a powerful method for simplifying dense datasets in parallel coordinate plots and similar visualizations. 
Grouping close-together values into bins minimizes overplotting, reduces noise, and highlights overarching trends. 
While it sacrifices some granularity, the technique is highly effective for exploratory data analysis and high-dimensional datasets where clarity is important. 
When applied thoughtfully, quantization balances detail and readability, making it a valuable tool for modern data visualization.

## Color-Coding and Transparency

By changing the color and transparency of lines, you can tell them apart based on density, categories, or values.
This makes it easier to tell the difference between PCP lines that meet.
Firat et al. say, "Line brushing and transparency adjustments improve the gestalt of the data clusters." This means that changes in how we see things help us group data cognitively without changing the structure.
Firat et al. say that user tests have shown that PCPs with color-coded and clear lines are easier to understand and recognize patterns, especially for differentiating categorical data [@firat2023].
This tool can be used to handle both numerical and categorical ties.
The color and transparency options make it easy to visually separate clusters without changing where the lines are placed.
However, this method might only work for plots with little information because even changes in color can't fully fix heavy overplotting.

## Edge Bundling for Categorical Data


Edge bundling, which comes from network visualization, groups paths for category values in PCPs.
This method works best with categorical data because it lets you visually break up ties without changing other factors.
Palmas et al. state that "bundling lines with similar orientations prevents overplotting, allowing clearer identification of dominant trends within complex data." This means bundling can help find trends even in spaces with many dimensions.
Bundling made finding categorical clusters in complex PCPs easier and decreased users' work [@palmas2014].
Edge bundling is an excellent way to clear up clutter and make categorical groups easier to see.
It lets users see categorical differences without messing up numerical relationships.
On the other hand, each bundle may hide small details, making them less useful for datasets that need a lot of precision.

## Stacked Histograms and Density Plots

This change adds histograms or density plots on top of PCPs to show how category data is distributed in terms of frequency.
This lets users see how distributions change without adding extra line clutter.
According to @bok2020augmenting, adding histogram overlays gives categorical context, making variable distributions easier to see without affecting line continuity.
This means that frequency-based cues can help you understand categorical distributions without adding more visual clutter.
Clear frequency-based differentiation in categorical data without too much line overlap improves the visual understanding of distributions when used with PCPs.
Real-world category dataset tests showed that histogram overlays made it easier to differentiate between data sets and see what they meant.
Adding histograms makes things look more complicated, which could be too much for some people if used with other PCP changes.


## Perceptual Cues (Line Thickness, Texture, etc.)

By changing the lines' width, texture, or other visual properties, you can tell them apart from overlapping lines.
This helps people see patterns and tell values apart without separating them physically.
According to @chang2018, perceptual variations in lines not only differentiate data but also enhance recognition of broader patterns. 
These cues help with cognitive grouping and pattern differentiation, even in complicated datasets.
They work well in areas with a lot of visual information because they let users see trends without changing the structure or order of the data.
They are helpful for both numerical and categorical ties.
Studies with users showed that changes in how people saw things made finding patterns and trends in large, complex datasets easier.
This made it easier for PCPs to look around.
In areas with many people, it could be useful because overlapped lines can make it harder to see.



\newpage
