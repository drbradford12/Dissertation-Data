---
title: "Visualizing Ambiguity: A Grammar of Graphics Approach to Resolving Numerical Ties in Parallel Coordinate Plots"
author: "Denise Bradford"
date: "`r format(Sys.Date(), '%B %Y')`"
format:
  pdf:
    toc: true
    number-sections: true
    colorlinks: true
    documentclass: article
    geometry: margin=1in
    fontsize: 11pt
    include-in-header:
      text: |
        \usepackage{soul}
        \usepackage[dvipsnames]{xcolor} % colors
        \newcommand{\db}[1]{{\textcolor{Green}{#1}}}
        \newcommand{\svp}[1]{{\textcolor{RedOrange}{#1}}}
        \newcommand{\hh}[1]{{\textcolor{blue}{#1}}}
    html:
      css: edits.css
bibliography: references_summary.bib
bibliographystyle: apa
filters:
   - latex-environment
commands: [db,svp,hh]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  message = FALSE, 
  warning = FALSE,
  fig.width = 8,
  fig.height = 5,
  dpi = 300
)

# Load required packages
library(GGally)
library(palmerpenguins)
library(tidyverse)
library(gridExtra)
library(ggpcp)
library(datasets)
library(knitr)
library(kableExtra)
library(ggforce)

source(here::here("numerical_tie_attempts/toy_example.R"))


# Set theme
theme_set(theme_bw(base_size = 11))


```

# Introduction

This proposal outlines a systematic approach to visually distinguish tied numerical values in multidimensional datasets by employing parallel coordinate plots (PCPs). 
Parallel coordinates, first popularized by Alfred Inselberg, are a powerful technique for investigating patterns across multiple attributes simultaneously [@inselberg2009]. 
However, when datasets contain exact numerical ties, the resulting overlapping lines in PCPs can obscure critical distinctions. 

To address this, we propose a uniform method for collected spacing to tied values.
The method will be integrated into the `ggpcp` package in R, ensuring a streamlined workflow for users seeking enhanced clarity in their parallel coordinate visualizations.

Importantly, our approach complements recent work on generalized parallel coordinate plots (GPCPs), an extension of PCPs that supports categorical variables [@vanderplas2023]. 
The `ggpcp` package for R implements these GPCPs using a grammar of graphics framework, which seamlessly incorporates both continuous and categorical variables in a single parallel coordinate plot. 
One of the key contributions of that work is a robust tie-breaking mechanism for categorical variables, implemented through the `pcp_arrange()` function with methods including "from-left" and "from-right" hierarchical sorting. 
This ensures that individual observations can be traced across multiple dimensions, even when categories induce identical or "tied" values. 

By adding multiple numerical tie-breaking techniques for continuous data—including our three deterministic approaches—we further refine GPCPs' capacity to handle the visualization of real-world datasets exhibiting many types of ties.

# Background and Motivation

## Parallel Coordinate Plots

Parallel coordinate plots assign each dimension of an $n$-dimensional dataset to a vertical axis arranged in parallel [@wegman1990]. 
Each observation is drawn as a polyline connecting its values on these axes, providing a visual representation that can illuminate underlying data structures.

## Numerical Ties and Visual Overlap

When multiple observations share the same value in a given dimension, their polylines perfectly overlap, creating "visual collisions." 
This masks information about distribution, density, or potential outliers. 
The treatment of ties is an aspect not generally addressed in the original parallel coordinate plots of Inselberg [-@inselberg1985] and Wegman [-@wegman1990]. 
However, the `ggpcp` implementation has demonstrated that careful tie-handling is essential for both continuous and categorical variables.

Introducing a small offset ("jitter") to these tied values can mitigate overlap without distorting the overall relationships in the data [@peng2004]. 
In the context of generalized parallel coordinate plots, the `ggpcp` package separates data management from visual rendering into three distinct components: variable selection and reshaping, scaling of axes, and treatment of ties in categorical axes [@vanderplas2023].

```{r ggpcp-workflow, fig.cap="ggpcp data wrangling workflow", out.width="70%"}
combined_ggpcp
```

## Existing Solutions for Categorical Ties in ggpcp

The `ggpcp` package currently addresses categorical ties through sophisticated tie-breaking algorithms. 
The package implements hierarchical sorting through the `pcp_arrange(data, method, space)` function, with two primary methods: "from-left" and "from-right", meaning that tie breaks are determined hierarchically by variables' values from the specified direction. 
The parameter `space` specifies the amount of the y-axis to use for spacing between levels of categorical variables the axis used for spacing.

This hierarchical sorting approach serves as "external cognition," the additional computational processing reduces the cognitive load required to untangle overlapping lines in the parallel coordinate plot. 
The categorical tie-breaking creates equispaced tie-breaking that reduces line crossings and allows users to follow individual observations from left to right through the plot even for categorical variables.

## The Challenge of Visualizing Mixed-Type Data

Parallel coordinate plots (PCPs) have been established as valuable tools for exploratory data analysis of high-dimensional numerical data since their introduction [@inselberg1985; @wegman1990]. 
However, the use of PCPs is fundamentally limited when working with categorical variables or mixed categorical-continuous data. 
As @vanderplas2023 note in their introduction to generalized parallel coordinate plots (GPCPs), existing solutions for categorical values become insufficient when attempting to maintain visual continuity across both data types.

The treatment of ties, multiple observations sharing the same value, represents a critical design decision that affects both perceptual effectiveness and analytical utility. 
As @vanderplas2023 observe, "The treatment of ties is an aspect not generally addressed in the original parallel coordinate plots of @inselberg1985 and @wegman1990. 
We have found a need to deal with ties" (p. 6). 
This observation extends naturally from categorical to numerical variables.

The ability to follow individual observations is central to the analytical power of PCPs, enabling users to identify patterns, outliers, and relationships that span multiple variables simultaneously.

### Step 1: Identify the Parallel Axes

Begin by identifying each vertical axis in the plot. 
Each axis represents one variable from the dataset. 
The axes are typically arranged from left to right, and the order may be determined by the data analyst to highlight specific relationships or minimize visual clutter.

![The parallel axes form the structural framework of the visualization.](images/pcp_line_tracing_guide_images/figure-1.png){#fig-figure-1 width="90%"}

### Step 2: Locate the Starting Point

Find the observation of interest on the leftmost axis. 
The vertical position indicates the scaled value of that observation for the first variable. 
If you are examining a highlighted or color-coded observation, look for its distinctive marker at this starting position.

![The starting point is identified on the first axis with its corresponding value.](images/pcp_line_tracing_guide_images/figure-2.png){#fig-figure-2 width="90%"}

### Step 3: Follow the Line Segment

Trace the line segment from the starting point to its intersection with the next axis. 
The human visual system naturally follows smooth, continuous paths due to the Gestalt principle of good continuation. 
This principle allows viewers to perceive connected lines as unified objects, making it easier to track observations across multiple variables.

![Following the line segment uses the Gestalt principle of good continuation.](images/pcp_line_tracing_guide_images/figure-3.png){#fig-figure-3 width="90%"}

### Step 4: Read Values at Intersections

At each axis intersection, the vertical position of the line indicates the observation's value for that variable. 
Read these values to understand how the observation changes across different dimensions of the data. 
The slope of line segments between axes provides information about the relationship between consecutive variables for that specific observation.

![Values are read as approximate scaled value relative to the total range.](images/pcp_line_tracing_guide_images/figure-4.png){#fig-figure-4 width="90%"}

### Step 5: Continue Across All Axes

Repeat the tracing process for each consecutive pair of axes until reaching the rightmost axis. 
By following the complete path, you obtain a comprehensive view of how that particular observation behaves across all measured variables. 
The vertical positions along each axis represent scaled values that can be interpreted as quantiles when the data are appropriately transformed.
This enables identification of unique characteristics, cluster membership, or outlier status.

![The complete traced path reveals the observation's values across all variables.](images/pcp_line_tracing_guide_images/figure-5.png){#fig-figure-5 width="90%"}

### Current State: ggpcp's Categorical Tie-Breaking

The ggpcp package implements a sophisticated tie-breaking algorithm for categorical variables that maintains individual observation traceability. 
The approach spaces observations evenly within categorical levels:

> "All observations are spaced out evenly. This results in a natural visualization of the marginal frequencies along each axis (additionally enhanced by the light gray boxes grouping observations in the same category) that is not as prominent in the previous three panels. The ordering of the observations within the level is such that a minimal number of line crossings occurs between the axes." (p. 11)

The algorithm achieves this through hierarchical sorting implemented in `pcp_arrange(data, method, space)`, where the `space` parameter specifies the proportion of the y-axis used for spacing between categorical levels (default 5%). 
This optimization can be formalized as:

$$d_i = \frac{S_i - S_i^- - S_i^+}{n_i - 1}$$

where:

-   $S_i$ is the total space allocated to category $i$
-   $S_i^-$ is the spacing below category $i$
-   $S_i^+$ is the spacing above category $i$
-   $n_i$ is the number of observations in category $i$
-   $d_i$ is the optimal spacing distance between consecutive observations

### Alternative Approach: Hammock Plots

Hammock plots, introduced by Schonlau [@schonlau2003, @schonlau2024], take a fundamentally different approach to handling both categorical and numerical variables. 
Rather than using individual lines, hammock plots employ two-dimensional boxes to connect adjacent axes, with box width proportional to the number of observations.

As @schonlau2024 describes:

> "Like a parallel coordinate plot, the axes are aligned parallel to one another. Categories of adjacent variables are connected by boxes. (The boxes shown are parallelograms; I use the word boxes for simplicity). The width of boxes is proportional to the number of observations." (p. 3)

For numerical variables specifically, hammock plots maintain constant-width boxes throughout the visualization. 
@schonlau2024 explains the spatial constraint this imposes:

> "When treating this variable as numerical, the range from 0 to 20 leaves 1/21th of the space for each unit length. Consequently, the widths of the boxes have to be more frugal." (p. 21)

This creates a fundamental trade-off: hammock plots explicitly encode frequency through box width but sacrifice individual observation traceability. 
As @schonlau2024 notes, "For small data sets, GPCP plots beautifully show all individual observations whereas hammock plots require highlighting to feature individual observations" (p. 19).

### Visual Comparison: Triangles vs. Boxes

A key visual difference emerges when connecting categorical to numerical variables. @vanderplas2023 observe:

> "When many observations have the same value for a categorical and an adjacent numerical variable, the corresponding area looks like a triangle... Notice the lines/boxes between the variables hospitalizations and comorbidities in the GPCP (Figure 13) and hammock plots (Figure 2). Most of the observations are in the boxes leading from hospitalizations=0 to either comorbidities=0 or comorbidities=1. This is far more obvious in the hammock plot than in the GPCP plot." (p. 19)

This observation suggests that each approach has perceptual advantages in different contexts, motivating rigorous comparative evaluation grounded in perceptual science.

Understanding the perceptual and practical challenges of parallel coordinate plots provides essential context for our tie-resolution methods. 
This section synthesizes empirical evidence from the visualization literature that directly informs our design decisions and evaluation strategy.

### The Line Width Illusion and Perceptual Constraints

Both approaches must contend with perceptual illusions that affect visual interpretation. 
@schonlau2024 discusses the line width illusion:

> "The distance between two parallel lines is perceived at a right angle rather than as the vertical distance between the lines (Wallgren et al., 1996; Tufte, 2001)... The line width illusion is part of the family of Müller-Lyer illusions where two lines of same length appear to be of different lengths." (p. 8)

@hofmann2013 further identify the "reverse line width illusion," where centering of lines creates a contextual cue encouraging evaluation of line widths using vertical rather than orthogonal measures. 
As they demonstrate empirically, this illusion can lead to systematic biases in frequency estimation.

![.](images/muller_lyer.png){#fig-muller}

The equispaced line approach proposed here may inherently avoid these illusions by maintaining parallel lines at consistent vertical spacing rather than using area-based encoding, though this requires empirical validation.

# Handling Numerical Ties

A significant challenge arises when multiple observations share identical values on an axis. 
In traditional PCPs, these observations converge to a single point, creating overlapping lines that make individual tracking impossible. 
The ggpcp package addresses this through the tie_spread algorithm.

## The Problem: Overlapping Lines

When multiple observations have the same value for a variable, their lines converge to a single point on that axis. 
This convergence creates visual clutter and breaks the continuity needed for individual observation tracking.

![Numerical ties cause lines to converge at a single point.](images/pcp_line_tracing_guide_images/figure-6.png){#fig-figure-6 width="90%"}

## The Solution: Tie Spreading

The `tie_spread` algorithm separates tied observations by distributing them evenly within a small range centered on their original value. 
By default, this range is set to maximize the available space for tiebreaking while preserving the approximate positions of values and maintaining visual separation.

![Tie spreading maintains visual separation while preserving approximate positions.](images/pcp_line_tracing_guide_images/figure-7.png){#fig-figure-7 width="90%"}


## Hierarchical Sorting for Minimal Crossings

Beyond simply spreading tied values, the ggpcp package implements hierarchical sorting to minimize line crossings as in categorical tie breaking.

By ordering observations within a tie group based on their values on adjacent axes, the package leverages the Gestalt principle of common fate. 
This strategy ensures that observations with similar trajectories are positioned in close proximity, creating cohesive visual bands. 
These bands facilitate the perception of distinct groups as they move together through high-dimensional space, reducing visual noise and highlighting underlying patterns.

![Hierarchical sorting reduces line crossings, making patterns easier to perceive.](images/pcp_line_tracing_guide_images/figure-8.png){#fig-figure-8 width="90%"}

## Theoretical Framework: Perception-Driven Design

Effective data visualizations must be grounded in how people actually see and process information. 
This theoretical framework draws on research from cognitive psychology and visual perception to explain how viewers interpret visual displays. 
The framework covers four key areas that trace the path from seeing a visualization to understanding its meaning. 
**Stage 1** explores how Gestalt principles help viewers group visual elements into meaningful patterns. 
**Stage 2** examines how visual working memory and attention allow people to hold and manipulate information while analyzing a visualization. 
**Preattentive processing** describes how certain visual features can be detected quickly and automatically, enabling rapid visual search before focused attention is required. 
Finally, **external cognition and computational offloading** addresses how visualizations act as external aids that extend our mental capabilities by shifting some cognitive work from our minds to the visual display itself. 
These four components provide a foundation for understanding how design choices affect visualization effectiveness.

<!--Colin Ware's "Information Visualization: Perception for Design" provides a comprehensive framework for understanding how humans process visual information [@ware2012, 3rd ed., pp. 20-21, Figure 1.11]. 
Ware describes visual perception as occurring in three distinct stages, each with specific implications for visualization design.

![Colin Ware's three-stage model of visual information processing, illustrating the flow from low-level feature extraction to goal-directed processing (adapted from Ware, 2012).](images/ware_three_stage_model.png){#fig-ware-stages width="60%"}


#### Stage 1: Parallel Processing of Low-Level Properties

The first stage involves rapid, parallel extraction of basic visual features across the entire visual field. 
As Ware describes, this preattentive processing occurs in under 500 milliseconds and requires no conscious effort. 
Four fundamental categories of preattentive visual properties exist:

**Form** is one of the most basic. 
It includes simple geometric cues—orientation, length, width, and size—as well as more structured cues like curvature and the way marks are grouped. 
Form also depends on how clearly something is rendered (sharp vs. blurred) and whether boundaries are emphasized through added marks or enclosing shapes.

**Color** provides another immediate signal. 
Differences in hue, brightness (intensity), and saturation let viewers separate categories or perceive gradients quickly, typically without much mental work.

**Spatial position** underlies nearly every visualization. 
At its simplest, it’s where something lands on a 2D plane via $(x, y)$ coordinates. 
Position can also suggest depth or distance through stereoscopic cues or shading that makes shapes appear concave or convex.

Finally, **motion** is especially effective at grabbing attention. 
Flicker or directional movement stands out strongly and can quickly indicate changes or relationships in data that unfold over time.

![Form-based pop-out: orientation and size. Color-based pop-out: hue; plus an intensity ramp. Spatial position (x,y) and implied depth via shading.](images/preattentive_images.png){#fig-preattentive}

These preattentive properties are critical for visualization design because they allow information to be perceived "at a glance" without requiring serial visual search. 
As Ware notes, it is easy to spot a single hawk in a sky full of pigeons, but if the sky contains many types of birds, the hawk becomes much harder to see—the distinctiveness of preattentive properties diminishes as visual variety increases.

While Colin Ware’s model provides a foundational understanding of the physiological stages of vision, researchers like Lace Padilla have expanded this framework to include the complex cognitive processes involved in decision-making.
@padilla2018 integrates Dual-Process Theory, which suggests that users oscillate between fast, intuitive "System 1" thinking and slow, deliberative "System 2" reasoning when interpreting data.

![Lace Padilla's cognitive model (Padilla et al., 2018).](images/padilla_processing.png){#fig-padilla width="60%"}

Ware’s framework is primarily a bottom-up, perceptual model that describes how the physical properties of a graphic (like color and orientation) are mechanically processed by the eye and brain. 
In contrast, Padilla’s model is a cognitive-integrative model that places greater emphasis on the user's prior knowledge and the dual nature of reasoning. 
While Ware’s "Stage 3" (Sequential Goal-Directed Processing) touches on cognition, Padilla delves deeper into how a user’s working memory and long-term expertise can override or bias the initial perceptual signals. 
For a package like ggpcp, Ware’s model explains why categorical tie-breaking helps the eye follow a line (low-level tracking), whereas Padilla’s model explains how those clear paths allow the user to transition from an intuitive "gut feeling" about a trend to a rigorous, analytical conclusion about the high-dimensional data.
-->

### Stage 1: Pattern Perception and Gestalt Principles

The first stage involves active pattern perception processes that segment the visual scene into coherent regions. 
The Gestalt laws of perceptual organization, articulated by German psychologists in 1912, remain fundamental principles for visualization design:

-   **Proximity:** Objects near each other are perceived as belonging together
-   **Similarity:** Objects sharing visual properties (color, shape, size) are grouped perceptually 
-   **Connectedness:** Objects connected by lines are seen as related\
-   **Continuity:** The visual system prefers interpretations with smooth, continuous paths 
-   **Symmetry:** Symmetric patterns are more easily perceived and remembered 
-   **Closure:** Incomplete shapes are perceptually completed 
-   **Common Fate:** Objects moving together are perceived as a group 
-   **Relative Size:** Smaller elements are perceived as figures against larger backgrounds



@vanderplas2023 explicitly invoke these principles in their design rationale for ggpcp:

> "By reducing the number of line crossings at non-axis points simplifies the plot, reducing the overall cognitive load required to 'untangle' (literally and metaphorically) the individual observations and leveraging the Gestalt principle of common fate." (p. 4)

The principle of **good continuation** is particularly relevant to parallel coordinate plots: can viewers smoothly follow individual lines through numerical ties, or do visual discontinuities disrupt the perceptual flow?

### Stage 2: Visual Working Memory and Attention

The seconnd stage involves conscious attention and visual working memory, which holds only a limited number of objects (typically 3-4) for active processing. 

This three-stage model has direct implications for evaluating tie-breaking strategies:

**Equispaced Lines:**

-   Leverage preattentive orientation and position
-   Support continuous line following (good continuation)
-   Implicitly encode frequency through density (requires stage 1 processing)

**Constant-Width Boxes:**

-   Leverage preattentive size and area
-   Explicitly encode frequency (reduced cognitive load)
-   May disrupt line continuity (challenges good continuation)

## Preattentive Processing and Visual Search

A key distinction between the two approaches concerns the nature of visual search required for different analytical tasks. Ware distinguishes between:

-   **Parallel Search (Preattentive):** Target pops out immediately, search time independent of number of distractors 
-   **Serial Search (Attentive):** Search time increases linearly with number of items, requiring conscious attention


For tracing individual observations through equispaced lines, the task may benefit from preattentive processing of orientation and position. 
Each observation maintains a consistent visual identity as a continuous line with specific orientation. 
In contrast, tracing through constant-width boxes requires conscious attention to reconstruct the path, as the area-based encoding does not support preattentive line following.

However, for frequency estimation tasks, constant-width boxes may have an advantage. 
Equispaced lines require inferring frequency from density, which is a second-order visual property requiring pattern perception (stage 1).

### External Cognition and Computational Offloading

@scaife1996 concept of "external cognition": 

> "While hierarchical sorting requires additional computations relative to the jittering or equally spaced solutions in Figure 5, this extra processing serves as 'external cognition' \[Scaife and Rogers, 1996\] - the additional computer time reduces the cognitive load required to untangle the lines" (p. 11)

This principle aligns with Ware's emphasis on reducing working memory load through careful visual design. 
By computing optimal line positions algorithmically, the equispaced approach offloads cognitive work from the viewer. 
Rather than the viewer mentally sorting and organizing lines, the visualization presents pre-organized information that leverages natural perceptual grouping.

Hammock plots achieve a different form of cognitive offloading by aggregating observations into boxes, explicitly computing and displaying frequency information. 
The trade-off is between individual-level detail (equispaced lines) and aggregate-level clarity (boxes).

### Gestalt Principles and Line Continuity

The principle of **good continuation** states that the human visual system preferentially perceives smooth, continuous contours over interpretations requiring abrupt changes in direction. 
This principle directly impacts the effectiveness of parallel coordinate plots for tracing individual observations.

Equispaced lines maintain continuity by representing each observation as a continuous polyline extending from the leftmost to the rightmost axis. 
When observations share identical numerical values (ties), the equispacing mechanism distributes lines within each category so that they remain visually distinct without introducing discontinuities. 
The ggpcp framework implements this through hierarchical sorting, which minimizes line crossings at axis intersections and leverages both the Gestalt principle of good continuation and the principle of common fate, wherein lines with similar values across multiple axes appear to move together through the display.

Constant-width boxes represent observations as aggregated area segments rather than individual lines. 
This encoding communicates aggregate quantities effectively and provides an immediate visual representation of bivariate contingency relationships. 
However, tracing a single observation through a box requires viewers to mentally reconstruct the implied path, engaging conscious attention and working memory. 
In this sense, the two approaches serve distinct analytical purposes: equispaced lines support individual-level tracing, while boxes support aggregate-level frequency comparison.

This distinction becomes increasingly relevant as dataset size grows. 
With many observations, equispaced lines may coalesce into ribbon-like bands, yet the continuity principle still applies—viewers can perceive flow patterns even when individual lines are indistinguishable. 
Boxes, by contrast, maintain their aggregate interpretation but are not designed to preserve individual-level information. 
Rather than viewing these as competing representations, they can be understood as complementary: the line-based approach is optimal when the analytical task involves following specific cases or detecting outliers, whereas the box-based approach is optimal when the task involves comparing category frequencies or understanding distributional patterns.

### The Challenge of Area Perception

Although area is preattentively processed, humans demonstrate notable difficulty in accurately comparing areas, particularly when aspect ratios vary. 
This limitation is well documented in @cleveland1984's hierarchy of elementary perceptual tasks, which ranks position along a common scale as the most accurate encoding, followed by length, angle, slope, area, and volume in decreasing order of precision.

Hammock plots and related box-based visualizations rely on area perception for frequency encoding. 
Observers must compare box widths (area divided by length) to estimate relative frequencies. 
The line width illusion and its reverse counterpart, documented extensively by @hofmann2013, further complicate these judgments by introducing systematic biases. 
Specifically, viewers tend to assess the orthogonal distance between curved or angled lines rather than the vertical distance that actually encodes the data, leading to perceptual distortion when comparing ribbons drawn at different angles.



Equispaced lines rely instead on density estimation, viewers count or estimate the number of lines within a given region. 
While density estimation also presents perceptual challenges, research suggests it may be less susceptible to geometric illusions that affect area judgment. 
Furthermore, density provides a more continuous encoding: frequencies can be estimated at any scale, from individual line counts to overall distributional patterns. 
Common angle plots, which use a fixed angle for all connecting segments between categories, represent one attempt to neutralize line width illusions in box-based displays while preserving aggregate frequency information.

### Visual Clutter and Information Density

Visual clutter constitutes a fundamental limitation on visualization effectiveness. 
Clutter occurs when too many visual elements compete for attention, overwhelming the viewer's capacity to extract meaningful patterns from the display.

The two approaches manage clutter through fundamentally different mechanisms. 
For equispaced lines, clutter increases with the number of observations, but hierarchical sorting minimizes line crossings and thereby reduces visual complexity. 
The approach exhibits graceful degradation: as density increases, individual lines transition perceptually into ribbons and eventually into filled areas, yet individual observations remain theoretically accessible for highlighting or interactive selection. 
For constant-width boxes, clutter depends primarily on the number of unique value combinations rather than on raw observation counts. 
Aggregation inherently reduces clutter, though at the cost of individual-level accessibility. 
The resulting display provides a clear representation of bivariate contingency relationships.

@dennig2021 formalize clutter metrics for parallel sets visualizations, measuring ribbon overlap, crossing angles, and ribbon width variance. 
These metrics can be adapted to compare the two approaches quantitatively and to guide the selection of dimension and category orderings that minimize visual complexity.

## Problem Statement and Research Question

### Main Research Question

**To what extent can the integration of equispaced line-spreading algorithms and constant-width frequency boxes preserve individual-level data integrity while facilitating aggregate-level insights in the presence of data ties?**

Parallel coordinate plots are a primary tool for multivariate data analysis, allowing researchers to observe relationships across multiple dimensions simultaneously. 
Their strength lies in individual-level tracing, where a single data point’s "path" can be followed through various axes to identify profiles and outliers.

### The Specific Conflict: Numerical Ties

A significant breakdown occurs when numerical ties (identical values) are present. Standard implementations cause these lines to overlap perfectly, creating two distinct issues:

- Loss of Visibility: Multiple observations appear as a single line, masking the true density or frequency of the data at that coordinate.
- Traceability Failure: When lines converge and then diverge at a tie, it becomes visually impossible to determine which incoming line corresponds to which outgoing line, a phenomenon known as "ambiguous crossings."

### The Limitations of Current Solutions

Existing visualization systems typically force a trade-off between two extremes:

- Individual Spreading: Techniques like equispaced line-spreading (e.g., "tie spreading") separate tied values to restore individual traceability. 
However, this often distorts the visual representation of density, making it difficult to judge the relative frequency of values at a glance.
- Aggregate Encoding: Approaches like constant-width boxes or frequency bars effectively communicate the "weight" of a tie (the forest) but completely sever the user’s ability to trace an individual observation (the tree) through the plot.

### Gap in Research

There is currently no established hybrid representation that preserves the mathematical integrity of individual line paths while simultaneously encoding aggregate frequency information. 
This lack of integration forces users to toggle between different views, creating cognitive friction and preventing a fluid transition between granular and high-level analytical perspectives during the discovery process.

Present implementations show a split:

1.  **ggpcp**: This method uses Gestalt principles of continuity and common fate to break ties between categorical variables in a smart way. 
However, when numbers are tied, the lines overlap.

2.  **Hammock plots**: All variable types have boxes with the same width, which makes frequency encoding clear, but you can't follow individual observations without highlighting them.

There is no current research that thoroughly evaluates these methodologies from the perspective of perceptual science or adapts ggpcp's optimization framework to numerical variables.

This gap is important because:

-   Mixed-type datasets are common in modern data analysis.
-   Different ways of visualizing data may work best for different types of analysis.
-   Perceptual trade-offs have not been quantified or empirically validated.
-   Design choices are not based on established principles of human visual perception.

### Suggested Fix

We suggest that ggpcp's categorical tie-breaking algorithm be expanded to include numerical variables, using the same optimization framework that keeps things evenly spaced.

For a number $v$ with $n$ tied observations:

1.  Find out how much space is available by looking at the values and data density of nearby items.
2.  Use spacing optimization: $spacing = \frac{available\_space}{n-1}$
3.  Organize observations in a hierarchical way and spread them out so they are perpendicular to the axis direction.
4.  Keep the rules of visual continuity in mind by making sure that lines flow smoothly from one to the next.

This creates a single framework where the same algorithm deals with both categorical and numerical ties. 
This could make things easier on the brain by keeping the visual grammar consistent and keeping the visual continuity across mixed-type data.


### Hierarchical Sorting for Line Crossing Minimization

To minimize line crossings and leverage the Gestalt principle of common fate, observations within each tie group are sorted hierarchically based on values on adjacent axes.

**Algorithm (Simplified):**

```         
For each tied group on axis i:
  Sort observations by (value on axis i+1, value on axis i-1)
  Assign positions y_{i,j} in sorted order
```

This ensures that observations with similar trajectories are positioned near each other, creating visual bands that support the perception of common fate.

## Implementation and Evaluation Plan

### Phase 1: Algorithm Development (Weeks 1-4)

**Deliverable:** Functional R package extension with comprehensive documentation

**Tasks:**

1.  Extend `pcp_arrange()` to detect and handle numerical ties
2.  Implement `optimize_spacing_numerical()` or `tie_spacing()` function with perceptually-motivated parameters
3.  Handle edge cases while preserving perceptual properties:
    -   Single unique value (centered position)
    -   Extreme skew (adaptive buffer sizing)
    -   Missing values (explicit separation region)
4.  Integration testing with existing ggpcp workflow

**Code Structure (Simplified):**

```{r}
optimize_spacing_numerical <- function(values, space = 0.05) {
  # 1. Identify unique values and their count
  unique_vals <- sort(unique(values))
  m <- length(unique_vals)
  
  # 2. Generate frequency table
  # Ensure it matches the sorted order of unique_vals
  freq <- as.numeric(table(values)[as.character(unique_vals)])
  
  # 3. Total available space
  # We subtract the sum of all gaps (space * (m - 1)) from the total 1.0 coordinate range
  total_gap_space <- space * (m - 1)
  available_width <- 1 - total_gap_space
  
  # 4. Proportional allocation
  # Divide the available width based on the relative frequency of each value
  widths <- (freq / sum(freq)) * available_width
  
  # 5. Calculate Positions
  # We calculate the starting point of each 'block' and then find the midpoint
  pos_midpoints <- numeric(m)
  current_pos <- 0
  
  for (i in 1:m) {
    # The midpoint is the current position plus half the width of the current block
    pos_midpoints[i] <- current_pos + (widths[i] / 2)
    
    # Advance the current position by the width of the block plus the inter-block space
    current_pos <- current_pos + widths[i] + space
  }
  
  # Return a named vector for easy lookup
  names(pos_midpoints) <- unique_vals
  return(pos_midpoints)
}
```

## Phase 2: Perceptual Validation Studies (Weeks 5–7)

**Study 1: Frequency Perception**

- **Duration:** Weeks 5–7
- **Participants:** n = 60 (30 per condition)
- **Design:** Between-subjects

**Procedure:**

1. Magnitude estimation (12 trials): "What percentage have value X?"
2. Ordinal comparison (12 trials): "Which value is more frequent?"
3. Ratio judgment (12 trials): "A is how many times B?"
4. Confidence ratings (7-point scale) for each response

**Analysis:**

- Absolute percentage error for magnitude estimation
- Accuracy rates for ordinal and ratio tasks
- Bias analysis: systematic over/under-estimation
- Confidence calibration: accuracy vs. subjective confidence

## Phase 3: Comparative Benchmarking (Weeks 6–10)

**Computational Metrics:**

1. Rendering performance (time, memory, scalability n = 2 to 100)
2. Visual quality metrics [@dennig2021]: line crossing count, ribbon overlap, visual clutter index
3. Perceptual quality estimates: modeled eye movements, predicted visual search time

**Case Studies:**

- Palmer Penguins: Mixed categorical-numerical data with known correlation structure
- Iris Dataset: Multiple numerical variables with natural ties
- Asthma Data [@schonlau2024]: Direct comparison with published hammock plot

## Phase 4: Integration and Dissemination (Weeks 8–12)

**Deliverables:**

1. **R Package Release (ggpcp v2.0):**
   - CRAN submission with full documentation
   - Vignette: "Handling Numerical Ties in Parallel Coordinate Plots"
   - Unit tests achieving >95% coverage

2. **Academic Paper:**
   - Target: IEEE Transactions on Visualization and Computer Graphics
   - Submission deadline: March 2026 (IEEE VIS)

3. **Supplementary Materials:**
   - Open Science Framework repository
   - All experimental stimuli and data
   - Reproducibility package

# Timeline and Milestones

```{r}
#| label: tbl-timeline
#| tbl-cap: "Research Timeline (12 Weeks)"

timeline <- data.frame(
  Week = c("1–2", "3–4", "4", "5–7", "8–10", "10–12"),
  Milestone = c(
    "Literature synthesis",
    "Core algorithm development",
    "IRB submission",
    "Study 1: Frequency perception",
    "Benchmarking",
    "Integration"
  ),
  Deliverable = c(
    "Annotated bibliography with Ware framework integration",
    "Working R code with perceptual properties verified",
    "Approved protocol for human subjects research",
    "Raw data and statistical analysis",
    "Performance report with computational metrics",
    "Draft manuscript and R package release"
  ),
  `Perceptual Focus` = c(
    "Ware framework integration",
    "Perceptual properties implemented",
    "Human subjects clearance",
    "Magnitude estimation validation",
    "Computational metrics",
    "Synthesis and dissemination"
  ),
  check.names = FALSE
)

kable(timeline, booktabs = TRUE, align = c("c", "l", "l", "l")) %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = TRUE,
                font_size = 10) %>%
  column_spec(1, bold = TRUE, width = "1.2cm") %>%
  column_spec(2, width = "3cm") %>%
  column_spec(3, width = "5cm") %>%
  column_spec(4, width = "3.5cm")
```

# Expected Contributions

## Theoretical Contributions

**Unified Tie-Breaking Theory:** Formalization of equispaced optimization for both categorical and numerical variables, with key perceptual properties (separability, continuity, space efficiency)

## Practical Contributions

1. **Production Software:** Open-source R package extension immediately usable by practicing data scientists and researchers

2. **Evidence-Based Guidelines:** Design recommendations grounded in empirical evidence and perceptual theory:
   - When to use equispaced lines vs. constant-width boxes
   - How to set spacing parameters for optimal perceptual clarity
   - Task-specific visualization selection criteria

3. **Benchmark Suite:** Reusable experimental framework and stimuli for evaluating future parallel coordinate plot innovations

## Methodological Contributions

1. **Theory-Driven Evaluation:** Demonstrates how established perceptual theory (Gestalt principles) can generate specific, testable hypothesis
2. **Multi-Method Approach:** Integrates behavioral experiments with computational benchmarking to triangulate findings

3. **Reproducible Research:** Complete open science package enabling replication and extension by other researchers

# Broader Impact

This research addresses visualization challenges across numerous domains where mixed categorical-numerical data is common:

```{r}
#| label: tbl-domains
#| tbl-cap: "Application Domains for Research Impact"

domains <- data.frame(
  Domain = c("Healthcare", "Manufacturing", "Social Science", "Finance", "Education"),
  Application = c(
    "Patient trajectory visualization",
    "Quality control monitoring",
    "Survey analysis",
    "Portfolio analysis",
    "Learning analytics"
  ),
  `Data Characteristics` = c(
    "Categorical diagnoses + numerical measurements",
    "Defect categories + continuous sensor readings",
    "Demographic categories + Likert scales",
    "Categorical sectors + numerical performance metrics",
    "Course completion + assessment scores"
  ),
  check.names = FALSE
)

kable(domains, booktabs = TRUE, align = c("l", "l", "l")) %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = TRUE,
                font_size = 10) %>%
  column_spec(1, bold = TRUE, width = "2.5cm") %>%
  column_spec(2, width = "4cm") %>%
  column_spec(3, width = "6cm")
```

By providing both theoretical understanding and practical tools, this work enables more effective exploratory data analysis across these domains, ultimately supporting better data-driven decision making.

# Limitations and Future Directions

## Study Limitations

- **Sample Characteristics:** University student population may not generalize to domain experts
- **Experimental Constraints:** Laboratory tasks may lack ecological validity
- **Scope:** Limited to static visualizations; interactive features not evaluated

## Future Extensions

- Longitudinal study with domain experts in real analytical workflows
- Investigation of interaction effects between individual differences and visualization method
- Hybrid approaches: smooth interpolation between lines and boxes based on dataset properties
- Integration with animation and interactive highlighting techniques

# Conclusion

This comprehensive examination proposal addresses a fundamental question in information visualization by grounding design decisions in Colin Ware's three-stage model of visual information processing. 
The proposed equispaced line approach extends ggpcp's proven categorical tie-breaking algorithm to numerical variables, creating a unified framework that maintains visual continuity, leverages preattentive processing, and supports Gestalt principles of good continuation and common fate.

Compared to hammock plots' constant-width boxes, equispaced lines offer different perceptual trade-offs: enhanced individual observation traceability and smoother visual flow at the potential cost of explicit frequency encoding. 
This research contributes to theory by demonstrating how established perceptual principles generate testable hypotheses about visualization effectiveness, to practice by delivering open-source software and evidence-based design guidelines, and to methodology by exemplifying theory-driven, multi-method evaluation.

As @ware2012 emphasizes, effective visualization must be grounded in understanding of human perception. 
This research takes that principle seriously, asking not just "which visualization looks better?" but rather "which visualization better aligns with the architecture of human visual processing for specific analytical tasks?" 
The answer, as with most visualization questions, is nuanced and context-dependent—but now it will be grounded in empirical evidence and perceptual theory.

## References
